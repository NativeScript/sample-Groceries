<Page loaded="loaded" xmlns:drawer="nativescript-telerik-ui/sidedrawer" xmlns:lv="component/listview">
	<Page.actionBar>
		<ActionBar title="Groceries">
			<ActionBar.actionItems>
				<ActionItem text="Sign out" tap="signOut" ios.position="left" />
				<ActionItem android.text="Share" tap="share" icon="res://share" ios.position="right" />
			</ActionBar.actionItems>
		</ActionBar>
	</Page.actionBar>

	<drawer:SideDrawer id="drawer" drawerLocation="Right">
		<drawer:SideDrawer.drawerTransition>
			<drawer:PushTransition />
		</drawer:SideDrawer.drawerTransition>
		<drawer:SideDrawer.mainContent>
			<GridLayout rows="auto, *" id="mainContent">
				<GridLayout cssClass="topSection" row="0" columns="*, auto">
					<TextField id="grocery" text="{{ grocery }}" hint="Enter a grocery item" returnKeyType="done" col="0" />
					<Image src="res://history" tap="history" col="1" />
				</GridLayout>
 
				<lv:ListView
					items="{{ groceryList }}"
					id="groceryList"
					cellReorder="true"
					selectionBehavior="none"
					swipeCells="true"
					didFinishSwipeCell="didFinishSwipeCell"
					pullToRefresh="true"
					shouldRefreshOnPull="shouldRefreshOnPull"
					row="1">
					<lv:ListView.listViewLayout>
						<lv:ListViewLinearLayout />
					</lv:ListView.listViewLayout>
					<lv:ListView.itemTemplate>
						<GridLayout columns="auto, *">
							<Image src="{{ done ? 'res://checked' : 'res://unchecked' }}" cssClass="checkbox" tap="toggleDone" col="0" />
							<Label text="{{ name }}" col="1" />
						</GridLayout>
					</lv:ListView.itemTemplate>
					<lv:ListView.itemSwipeTemplate>
						<GridLayout columns="60, *, 180">
							<Button text="Done" col="0" cssClass="doneButton" />
							<Label text="{{ foo }}" col="1" />
							<Button text="Delete" col="2" cssClass="deleteButton" />
						</GridLayout>
					</lv:ListView.itemSwipeTemplate>
				</lv:ListView>

				<ActivityIndicator busy="{{ isLoading }}" rowSpan="2" />
			</GridLayout>
		</drawer:SideDrawer.mainContent>
		<drawer:SideDrawer.drawerContent>
			<GridLayout rows="auto, *, auto" id="drawerContent">
				<Label text="Add recent items" cssClass="heading" row="0" />
				<lv:ListView id="history" items="{{ history }}" row="1">
					<lv:ListView.listViewLayout>
						<lv:ListViewLinearLayout />
					</lv:ListView.listViewLayout>
					<lv:ListView.itemTemplate>
						<StackLayout orientation="horizontal">
							<Image src="{{ done ? 'res://selected' : 'res://add-to-groceries' }}" tap="toggleHistory" cssClass="addButton" />
							<Label text="{{ name }}" />
						</StackLayout>
					</lv:ListView.itemTemplate>
				</lv:ListView>
				<Button text="Add to the groceries list" tap="addFromHistory" cssClass="addAllButton" row="2" />
				<ActivityIndicator busy="{{ isHistoryLoading }}"
					rowSpan="3" />
			</GridLayout>
		</drawer:SideDrawer.drawerContent>
	</drawer:SideDrawer>
</Page>